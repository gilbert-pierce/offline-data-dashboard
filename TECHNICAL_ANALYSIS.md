# 技术方案分析：离线数据看板 (Offline Data Dashboard)

根据您的需求，这是一个需要在 Windows 10 环境下无网运行、支持 Excel 导入、拖拽布局、切片器过滤以及时间轴展示的单文件/便携式应用程序。

作为 React 高级工程师，我的核心思路是：**构建一个功能完备的纯前端 React 应用 (SPA)，利用浏览器引擎的强大渲染能力，然后通过轻量级容器技术将其打包为 EXE。**

这种架构可以完美满足“无网”、“本地运行”、“Excel解析”和“拖拽UI”的需求。

## 核心功能技术实现 (通用)

无论选择哪种打包方案，React 层的核心技术栈如下：

1.  **Excel 解析 (本地无网)**: 使用 `xlsx` (SheetJS) 库。
    *   *原理*: 利用 HTML5 File API 读取用户选中的文件，直接在内存中解析，不需要上传到服务器，完全离线。
2.  **图表渲染**: 使用 `recharts`。
    *   *特点*: 基于 React 组件，轻量、美观，支持响应式，易于通过数据驱动改变图表类型。
3.  **拖拽排布 (Dashboard)**: 使用 `react-grid-layout`。
    *   *原理*: 这是一个成熟的 React 库，专门用于构建可拖拽、可调整大小的网格布局（类似 PowerBI 或 Grafana 的交互）。
4.  **切片器 (Slicer) & 状态管理**: 使用 React `Context` 或 `Zustand`。
    *   *原理*: 将 Excel 数据加载到全局 Store，切片器作为过滤器更新 Store 中的 `filter` 条件，所有图表组件监听 Store 变化并自动重绘。
5.  **事件浏览框**: 使用 `react-window` 或原生 CSS `overflow-y: scroll`。
    *   *原理*: 解析 Excel 中的时间和事件列，生成一个时间轴列表组件。

---

## 推荐的三套打包方案

为了满足“EXE 文件不要太大”且“可复制”的需求，以下是三个建议方案：

### 方案 1: Tauri + React (强烈推荐 ⭐⭐⭐)

这是目前最符合您“体积小、性能高”要求的现代方案。

*   **技术栈**: Rust (后端/壳) + React/TypeScript (前端 UI)。
*   **原理**: Tauri 不会打包整个浏览器（如 Chrome），而是直接调用 Windows 10 自带的 WebView2 (Edge内核)。
*   **EXE 体积**: 极小 (约 3MB - 10MB)。
*   **优点**:
    *   符合“文件不要太大”的极致要求。
    *   启动速度极快。
    *   安全性高，内存占用低。
*   **缺点**: 开发环境需要配置 Rust（但我生成的 React 代码可以直接放入 Tauri 项目的 `src` 中使用，无需修改）。

### 方案 2: Electron + React (行业标准)

如果不介意体积，这是最成熟的方案。

*   **技术栈**: Node.js (主进程) + React (渲染进程)。
*   **原理**: 将整个 Chromium 浏览器和 Node.js 运行时打包在 EXE 中。
*   **EXE 体积**: 较大 (约 80MB - 150MB)。
*   **优点**: API 极其丰富，完全抹平系统差异，社区资源最丰富。
*   **缺点**: 体积大，分发不便，内存占用较高。

### 方案 3: Neutralinojs + React (折中方案)

类似 Tauri，但使用其他语言作为后端，或者纯轻量化设计。

*   **技术栈**: Neutralinojs (轻量级 SDK) + React。
*   **原理**: 同样使用系统自带 WebView，但不需要 Rust，使用基于 WebSocket 的轻量级通讯。
*   **EXE 体积**: 很小 (约 5MB)。
*   **优点**: 开发比 Tauri 简单（不需要懂 Rust），体积比 Electron 小得多。
*   **缺点**: 社区生态不如前两者成熟，但在简单的本地文件读取场景下完全够用。

---

## 我的建议

**建议选择“方案 1 (Tauri)”的架构思路。**

虽然我作为 AI 目前只能为您生成 **React 前端部分** 的代码（因为我无法为您编译 EXE），但我可以为您构建一个**完全包含所有业务逻辑的 React 应用**。

**接下来的开发步骤：**

1.  **我为您生成 React 代码**: 包含文件上传、Excel 解析逻辑、拖拽看板 UI、切片器逻辑和图表组件。
2.  **您在本地运行**: 您可以在本地浏览器中直接运行和测试这个 React 应用（它完全支持离线运行）。
3.  **打包为 EXE**: 您只需要下载 Tauri 或 Electron 的官方模板，将我生成的 `dist` (构建后的网页文件) 放入其中运行 build 命令，即可得到 EXE。

**如果您准备好了，请回复确认（例如：“确认使用 React 核心方案”），我将立即为您编写包含以下核心模块的代码：**

*   `DashboardLayout`: 基于 Grid 的拖拽容器。
*   `ExcelImporter`: 本地文件读取与解析器。
*   `ChartWidget`: 动态图表组件（支持柱状图、折线图、饼图切换）。
*   `DataSlicer`: 全局数据切片控制器。
*   `EventTimeline`: 时间轴滚动组件。
